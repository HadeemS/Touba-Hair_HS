import{r as l,g as w,a as h,j as e}from"./index-Df9NR534.js";import{c as D}from"./timeSlots-qFR2TWJe.js";const E=()=>{const[d,v]=l.useState([]),[g,u]=l.useState(!0),[n,b]=l.useState({total:0,upcoming:0,completed:0,cancelled:0}),[r,f]=l.useState("all"),[c,x]=l.useState(""),o=w();l.useEffect(()=>{m()},[r,c]);const m=async()=>{try{u(!0);const s={};r!=="all"&&(s.status=r),c&&(s.date=c);const a=(await h.getAll(s)).appointments||[],A=a.sort((t,p)=>{const N=t.date.localeCompare(p.date);return N!==0?N:t.timeSlot.localeCompare(p.timeSlot)});v(A);const S=new Date().toISOString().split("T")[0];b({total:a.length,upcoming:a.filter(t=>t.status==="confirmed"&&t.date>=S).length,completed:a.filter(t=>t.status==="completed").length,cancelled:a.filter(t=>t.status==="cancelled").length})}catch(s){console.error("Error loading appointments:",s),alert("Failed to load appointments. Please try again.")}finally{u(!1)}},j=async(s,i)=>{try{await h.updateStatus(s,i),await m(),alert(`Appointment status updated to ${i}`)}catch(a){console.error("Error updating status:",a),alert("Failed to update status. Please try again.")}},y=async s=>{if(window.confirm("Are you sure you want to cancel this appointment?"))try{await h.cancel(s),await m(),alert("Appointment cancelled successfully")}catch(i){console.error("Error cancelling appointment:",i),alert("Failed to cancel appointment. Please try again.")}},C=s=>{switch(s){case"confirmed":return"status-badge confirmed";case"completed":return"status-badge completed";case"cancelled":return"status-badge cancelled";case"pending":return"status-badge pending";default:return"status-badge"}};return g?e.jsx("div",{className:"admin-dashboard",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"loading",children:"Loading dashboard..."})})}):e.jsx("div",{className:"admin-dashboard",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h1",{className:"page-title",children:"Admin Dashboard"}),e.jsxs("p",{className:"page-subtitle",children:["Welcome back, ",(o==null?void 0:o.name)||"Admin","!"]})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ“…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:n.total}),e.jsx("p",{className:"stat-label",children:"Total Appointments"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"â°"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:n.upcoming}),e.jsx("p",{className:"stat-label",children:"Upcoming"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âœ…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:n.completed}),e.jsx("p",{className:"stat-label",children:"Completed"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âŒ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:n.cancelled}),e.jsx("p",{className:"stat-label",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"dashboard-filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"status-filter",children:"Filter by Status:"}),e.jsxs("select",{id:"status-filter",value:r,onChange:s=>f(s.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"All Appointments"}),e.jsx("option",{value:"confirmed",children:"Upcoming"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"pending",children:"Pending"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"date-filter",children:"Filter by Date:"}),e.jsx("input",{type:"date",id:"date-filter",value:c,onChange:s=>x(s.target.value),className:"filter-input"}),c&&e.jsx("button",{onClick:()=>x(""),className:"clear-filter-btn",children:"Clear"})]})]}),e.jsxs("div",{className:"appointments-section",children:[e.jsxs("h2",{className:"section-heading",children:["Appointments (",d.length,")"]}),d.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“…"}),e.jsx("h3",{children:"No appointments found"}),e.jsx("p",{children:"Try adjusting your filters"})]}):e.jsx("div",{className:"appointments-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date & Time"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Braider"}),e.jsx("th",{children:"Service"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"datetime-cell",children:[e.jsx("div",{className:"date",children:D(s.date)}),e.jsx("div",{className:"time",children:s.timeSlot})]})}),e.jsx("td",{children:e.jsxs("div",{className:"client-cell",children:[e.jsx("div",{className:"client-name",children:s.customerName}),e.jsx("div",{className:"client-contact",children:s.customerEmail}),e.jsx("div",{className:"client-contact",children:s.customerPhone})]})}),e.jsx("td",{children:e.jsx("div",{className:"braider-cell",children:s.braiderName})}),e.jsx("td",{children:e.jsxs("div",{className:"service-cell",children:[s.serviceName||"Hair Braiding",s.servicePrice>0&&e.jsxs("div",{className:"service-price",children:["$",s.servicePrice]})]})}),e.jsx("td",{children:e.jsx("span",{className:C(s.status),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[s.status==="confirmed"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>j(s._id,"completed"),title:"Mark as completed",children:"âœ“ Complete"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>y(s._id),title:"Cancel appointment",children:"âœ• Cancel"})]}),s.status==="pending"&&e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>j(s._id,"confirmed"),title:"Confirm appointment",children:"Confirm"})]})})]},s._id))})]})})]})]})})};export{E as default};
