import{u as R,e as A,r as o,g as B,f as u,d as w,j as e,h as E,l as P}from"./index-end0shK6.js";import{t as y}from"./toast-6IGnTReI.js";const I=()=>{var b,j;const i=R(),v=A(),[t,S]=o.useState({email:"",password:""}),[g,s]=o.useState(""),[h,x]=o.useState(!1),[d,k]=o.useState(!1),[n,c]=o.useState("checking"),[z,C]=o.useState(null),p=((j=(b=v.state)==null?void 0:b.from)==null?void 0:j.pathname)||"/my-bookings";o.useEffect(()=>{const r=B();r&&(C(r),u()?i("/admin",{replace:!0}):w()?i("/braider-profile",{replace:!0}):i(p,{replace:!0}))},[i,p]);const m=async()=>{var r;c("checking"),s("");try{const a=await E();a.status==="ok"&&((r=a.database)!=null&&r.isConnected)?(c("online"),s("")):(c("degraded"),s("Server is starting up. Please wait a moment and try again."))}catch{c("offline"),s("Cannot connect to server. The backend may be starting up. Please wait a moment.")}};o.useEffect(()=>{m()},[]);const f=r=>{S({...t,[r.target.name]:r.target.value}),s("")},N=async r=>{r.preventDefault(),s(""),x(!0);try{const a=await P(t.email,t.password);if(a.success)requestAnimationFrame(()=>{u()?i("/admin",{replace:!0}):w()?i("/braider-profile",{replace:!0}):i(p,{replace:!0})});else{const l=a.error||"Invalid email or password";y.error(l),s(l)}}catch(a){const l=a.message||"An error occurred. Please try again.";y.error(l),s(l)}finally{x(!1)}};return e.jsx("div",{className:"login-page",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"login-card",children:[e.jsxs("div",{className:"login-header",children:[e.jsx("h1",{className:"login-title",children:"Welcome Back"}),e.jsx("p",{className:"login-subtitle",children:"Sign in to access your account"})]}),n==="offline"&&e.jsx("div",{className:"error-message",style:{backgroundColor:"#fff3cd",color:"#856404",border:"1px solid #ffc107",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"âš ï¸ Server is offline"}),e.jsx("p",{style:{margin:"5px 0 0 0",fontSize:"0.9em"},children:"The backend may be starting up. Free Render services sleep after 15 minutes of inactivity and take 30-60 seconds to wake up."})]}),e.jsx("button",{type:"button",onClick:m,style:{padding:"8px 16px",backgroundColor:"#ffc107",color:"#856404",border:"1px solid #ffc107",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:n==="checking"?"Checking...":"Check Server"})]})}),n==="degraded"&&e.jsx("div",{className:"error-message",style:{backgroundColor:"#fff3cd",color:"#856404",border:"1px solid #ffc107",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"âš ï¸ Database is connecting"}),e.jsx("p",{style:{margin:"5px 0 0 0",fontSize:"0.9em"},children:"Please wait a moment and try again."})]}),e.jsx("button",{type:"button",onClick:m,style:{padding:"8px 16px",backgroundColor:"#ffc107",color:"#856404",border:"1px solid #ffc107",borderRadius:"4px",cursor:"pointer",fontWeight:"bold",whiteSpace:"nowrap"},children:n==="checking"?"Checking...":"Refresh"})]})}),n==="checking"&&e.jsx("div",{className:"error-message",style:{backgroundColor:"#d1ecf1",color:"#0c5460",border:"1px solid #bee5eb",padding:"15px",borderRadius:"8px",marginBottom:"15px"},children:"ðŸ”„ Checking server status..."}),n==="online"&&e.jsx("div",{className:"error-message",style:{backgroundColor:"#d4edda",color:"#155724",border:"1px solid #c3e6cb",padding:"10px 15px",borderRadius:"8px",marginBottom:"15px",fontSize:"0.9em"},children:"âœ… Server is online and ready"}),g&&n==="online"&&e.jsx("div",{className:"error-message",children:g}),e.jsxs("form",{onSubmit:N,className:"login-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",name:"email",value:t.email,onChange:f,required:!0,placeholder:"your.email@example.com",autoComplete:"email"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"password-input-wrapper",children:[e.jsx("input",{type:d?"text":"password",id:"password",name:"password",value:t.password,onChange:f,required:!0,placeholder:"Enter your password",autoComplete:"current-password",className:"password-input"}),e.jsx("button",{type:"button",className:"password-toggle",onClick:()=>k(!d),"aria-label":d?"Hide password":"Show password",title:d?"Hide password":"Show password",children:d?e.jsx("span",{className:"password-icon","aria-hidden":"true",children:"Hide"}):e.jsx("span",{className:"password-icon","aria-hidden":"true",children:"Show"})})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-large",disabled:h,children:h?"Signing in...":"Sign In"})]}),u()&&e.jsxs("div",{className:"login-admin-section",style:{marginTop:"20px",padding:"15px",backgroundColor:"#f8f9fa",borderRadius:"8px",border:"1px solid #dee2e6"},children:[e.jsx("h3",{style:{fontSize:"14px",marginBottom:"10px",color:"#6c757d"},children:"Admin Access"}),e.jsx("p",{style:{fontSize:"12px",color:"#6c757d",margin:0},children:"You are logged in as an administrator."})]}),e.jsxs("div",{className:"login-footer",children:[e.jsxs("p",{children:["Don't have an account? ",e.jsx("a",{href:"/register",children:"Sign up here"})]}),e.jsxs("p",{children:["Are you a braider? ",e.jsx("a",{href:"/braider-register",children:"Create braider account"})]})]})]})})})};export{I as default};
