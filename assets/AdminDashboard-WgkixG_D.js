import{r as l,g as D,a as u,j as e}from"./index-ekhgIEl4.js";import{c as F}from"./timeSlots-qFR2TWJe.js";import{t as i}from"./toast-6IGnTReI.js";const E=()=>{const[o,g]=l.useState([]),[b,x]=l.useState(!0),[n,f]=l.useState({total:0,upcoming:0,completed:0,cancelled:0}),[d,y]=l.useState("all"),[c,j]=l.useState(""),m=D();l.useEffect(()=>{h()},[d,c]);const h=async()=>{try{x(!0);const s={};d!=="all"&&(s.status=d),c&&(s.date=c);const a=(await u.getAll(s)).appointments||[],S=a.sort((t,N)=>{const v=t.date.localeCompare(N.date);return v!==0?v:t.timeSlot.localeCompare(N.timeSlot)});g(S);const w=new Date().toISOString().split("T")[0];f({total:a.length,upcoming:a.filter(t=>t.status==="confirmed"&&t.date>=w).length,completed:a.filter(t=>t.status==="completed").length,cancelled:a.filter(t=>t.status==="cancelled").length})}catch{i.error("Failed to load appointments. Please try again.")}finally{x(!1)}},p=async(s,r)=>{try{await u.updateStatus(s,r),await h(),i.success(`Appointment status updated to ${r}`)}catch{i.error("Failed to update status. Please try again.")}},C=async s=>{if(window.confirm("Are you sure you want to cancel this appointment?"))try{await u.cancel(s),await h(),i.success("Appointment cancelled successfully")}catch{i.error("Failed to cancel appointment. Please try again.")}},A=s=>{switch(s){case"confirmed":return"status-badge confirmed";case"completed":return"status-badge completed";case"cancelled":return"status-badge cancelled";case"pending":return"status-badge pending";default:return"status-badge"}};return b?e.jsx("div",{className:"admin-dashboard",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"loading",children:"Loading dashboard..."})})}):e.jsx("div",{className:"admin-dashboard",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h1",{className:"page-title",children:"Admin Dashboard"}),e.jsxs("p",{className:"page-subtitle",children:["Welcome back, ",(m==null?void 0:m.name)||"Admin","!"]})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ“…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:n.total}),e.jsx("p",{className:"stat-label",children:"Total Appointments"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"â°"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:n.upcoming}),e.jsx("p",{className:"stat-label",children:"Upcoming"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âœ…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:n.completed}),e.jsx("p",{className:"stat-label",children:"Completed"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âŒ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:n.cancelled}),e.jsx("p",{className:"stat-label",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"dashboard-filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"status-filter",children:"Filter by Status:"}),e.jsxs("select",{id:"status-filter",value:d,onChange:s=>y(s.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"All Appointments"}),e.jsx("option",{value:"confirmed",children:"Upcoming"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"pending",children:"Pending"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"date-filter",children:"Filter by Date:"}),e.jsx("input",{type:"date",id:"date-filter",value:c,onChange:s=>j(s.target.value),className:"filter-input"}),c&&e.jsx("button",{onClick:()=>j(""),className:"clear-filter-btn",children:"Clear"})]})]}),e.jsxs("div",{className:"appointments-section",children:[e.jsxs("h2",{className:"section-heading",children:["Appointments (",o.length,")"]}),o.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“…"}),e.jsx("h3",{children:"No appointments found"}),e.jsx("p",{children:"Try adjusting your filters"})]}):e.jsx("div",{className:"appointments-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date & Time"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Braider"}),e.jsx("th",{children:"Service"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:o.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"datetime-cell",children:[e.jsx("div",{className:"date",children:F(s.date)}),e.jsx("div",{className:"time",children:s.timeSlot})]})}),e.jsx("td",{children:e.jsxs("div",{className:"client-cell",children:[e.jsx("div",{className:"client-name",children:s.customerName}),e.jsx("div",{className:"client-contact",children:s.customerEmail}),e.jsx("div",{className:"client-contact",children:s.customerPhone})]})}),e.jsx("td",{children:e.jsx("div",{className:"braider-cell",children:s.braiderName})}),e.jsx("td",{children:e.jsxs("div",{className:"service-cell",children:[s.serviceName||"Hair Braiding",s.servicePrice>0&&e.jsxs("div",{className:"service-price",children:["$",s.servicePrice]})]})}),e.jsx("td",{children:e.jsx("span",{className:A(s.status),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[s.status==="confirmed"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>p(s._id,"completed"),title:"Mark as completed",children:"âœ“ Complete"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>C(s._id),title:"Cancel appointment",children:"âœ• Cancel"})]}),s.status==="pending"&&e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>p(s._id,"confirmed"),title:"Confirm appointment",children:"Confirm"})]})})]},s._id))})]})})]})]})})};export{E as default};
