import{r as a,g as E,c as S,a as p,j as e}from"./index-D81LPs97.js";import{c as _}from"./timeSlots-qFR2TWJe.js";import{t as i}from"./toast-6IGnTReI.js";const L=()=>{const[o,A]=a.useState([]),[B,u]=a.useState(!0),[d,w]=a.useState({total:0,upcoming:0,completed:0,cancelled:0}),[c,k]=a.useState("all"),[n,j]=a.useState(""),[g,P]=a.useState([]),[h,z]=a.useState(!1),[b,f]=a.useState(!1),m=E();a.useEffect(()=>{x(),N()},[c,n]);const N=async()=>{try{const s=await S.getBraiderCredentials();P(s.credentials||[])}catch{}},D=async()=>{if(window.confirm("This will create or update braider accounts with pre-set credentials. Continue?"))try{f(!0);const s=await S.initializeBraiders();i.success(`Braider accounts initialized! Created: ${s.results.created.length}, Updated: ${s.results.updated.length}`),await N()}catch(s){i.error(s.message||"Failed to initialize braider accounts")}finally{f(!1)}},x=async()=>{try{u(!0);const s={};c!=="all"&&(s.status=c),n&&(s.date=n);const r=(await p.getAll(s)).appointments||[],T=r.sort((t,y)=>{const C=t.date.localeCompare(y.date);return C!==0?C:t.timeSlot.localeCompare(y.timeSlot)});A(T);const U=new Date().toISOString().split("T")[0];w({total:r.length,upcoming:r.filter(t=>t.status==="confirmed"&&t.date>=U).length,completed:r.filter(t=>t.status==="completed").length,cancelled:r.filter(t=>t.status==="cancelled").length})}catch{i.error("Failed to load appointments. Please try again.")}finally{u(!1)}},v=async(s,l)=>{try{await p.updateStatus(s,l),await x(),i.success(`Appointment status updated to ${l}`)}catch{i.error("Failed to update status. Please try again.")}},F=async s=>{if(window.confirm("Are you sure you want to cancel this appointment?"))try{await p.cancel(s),await x(),i.success("Appointment cancelled successfully")}catch{i.error("Failed to cancel appointment. Please try again.")}},I=s=>{switch(s){case"confirmed":return"status-badge confirmed";case"completed":return"status-badge completed";case"cancelled":return"status-badge cancelled";case"pending":return"status-badge pending";default:return"status-badge"}};return B?e.jsx("div",{className:"admin-dashboard",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"loading",children:"Loading dashboard..."})})}):e.jsx("div",{className:"admin-dashboard",children:e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h1",{className:"page-title",children:"Admin Dashboard"}),e.jsxs("p",{className:"page-subtitle",children:["Welcome back, ",(m==null?void 0:m.name)||"Admin","!"]})]}),e.jsxs("div",{className:"admin-section",style:{marginBottom:"30px",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[e.jsx("h2",{style:{margin:0,fontSize:"20px"},children:"Braider Account Management"}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>z(!h),children:[h?"Hide":"Show"," Braider Credentials"]})]}),h&&e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:"15px",color:"#6c757d"},children:"Manage pre-set braider credentials. Braiders use these credentials to log in."}),e.jsx("button",{className:"btn btn-primary",onClick:D,disabled:b,style:{marginBottom:"20px"},children:b?"Initializing...":"Initialize Braider Accounts"}),g.length>0&&e.jsxs("div",{className:"braider-credentials-table",style:{marginTop:"20px"},children:[e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#e9ecef"},children:[e.jsx("th",{style:{padding:"10px",textAlign:"left",border:"1px solid #dee2e6"},children:"Braider"}),e.jsx("th",{style:{padding:"10px",textAlign:"left",border:"1px solid #dee2e6"},children:"Email"}),e.jsx("th",{style:{padding:"10px",textAlign:"left",border:"1px solid #dee2e6"},children:"Phone"}),e.jsx("th",{style:{padding:"10px",textAlign:"left",border:"1px solid #dee2e6"},children:"Braider ID"})]})}),e.jsx("tbody",{children:g.map((s,l)=>e.jsxs("tr",{style:{backgroundColor:l%2===0?"#fff":"#f8f9fa"},children:[e.jsx("td",{style:{padding:"10px",border:"1px solid #dee2e6"},children:s.name}),e.jsx("td",{style:{padding:"10px",border:"1px solid #dee2e6"},children:s.email}),e.jsx("td",{style:{padding:"10px",border:"1px solid #dee2e6"},children:s.phone||"N/A"}),e.jsx("td",{style:{padding:"10px",border:"1px solid #dee2e6"},children:s.braiderId})]},l))})]}),e.jsxs("p",{style:{marginTop:"15px",fontSize:"14px",color:"#6c757d"},children:[e.jsx("strong",{children:"Note:"})," Passwords are stored securely and not displayed here. Braiders should contact you for their login credentials."]})]})]})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"ðŸ“…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:d.total}),e.jsx("p",{className:"stat-label",children:"Total Appointments"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"â°"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:d.upcoming}),e.jsx("p",{className:"stat-label",children:"Upcoming"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âœ…"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:d.completed}),e.jsx("p",{className:"stat-label",children:"Completed"})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:"âŒ"}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{className:"stat-value",children:d.cancelled}),e.jsx("p",{className:"stat-label",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"dashboard-filters",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"status-filter",children:"Filter by Status:"}),e.jsxs("select",{id:"status-filter",value:c,onChange:s=>k(s.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"All Appointments"}),e.jsx("option",{value:"confirmed",children:"Upcoming"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"pending",children:"Pending"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{htmlFor:"date-filter",children:"Filter by Date:"}),e.jsx("input",{type:"date",id:"date-filter",value:n,onChange:s=>j(s.target.value),className:"filter-input"}),n&&e.jsx("button",{onClick:()=>j(""),className:"clear-filter-btn",children:"Clear"})]})]}),e.jsxs("div",{className:"appointments-section",children:[e.jsxs("h2",{className:"section-heading",children:["Appointments (",o.length,")"]}),o.length===0?e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-icon",children:"ðŸ“…"}),e.jsx("h3",{children:"No appointments found"}),e.jsx("p",{children:"Try adjusting your filters"})]}):e.jsx("div",{className:"appointments-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date & Time"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Braider"}),e.jsx("th",{children:"Service"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:o.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"datetime-cell",children:[e.jsx("div",{className:"date",children:_(s.date)}),e.jsx("div",{className:"time",children:s.timeSlot})]})}),e.jsx("td",{children:e.jsxs("div",{className:"client-cell",children:[e.jsx("div",{className:"client-name",children:s.customerName}),e.jsx("div",{className:"client-contact",children:s.customerEmail}),e.jsx("div",{className:"client-contact",children:s.customerPhone})]})}),e.jsx("td",{children:e.jsx("div",{className:"braider-cell",children:s.braiderName})}),e.jsx("td",{children:e.jsxs("div",{className:"service-cell",children:[s.serviceName||"Hair Braiding",s.servicePrice>0&&e.jsxs("div",{className:"service-price",children:["$",s.servicePrice]})]})}),e.jsx("td",{children:e.jsx("span",{className:I(s.status),children:s.status.charAt(0).toUpperCase()+s.status.slice(1)})}),e.jsx("td",{children:e.jsxs("div",{className:"action-buttons",children:[s.status==="confirmed"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-sm",onClick:()=>v(s._id,"completed"),title:"Mark as completed",children:"âœ“ Complete"}),e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>F(s._id),title:"Cancel appointment",children:"âœ• Cancel"})]}),s.status==="pending"&&e.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>v(s._id,"confirmed"),title:"Confirm appointment",children:"Confirm"})]})})]},s._id))})]})})]})]})})};export{L as default};
